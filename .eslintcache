[{"/Users/sean/Documents/sean/code/experience-station/src/index.js":"1","/Users/sean/Documents/sean/code/experience-station/src/reportWebVitals.js":"2","/Users/sean/Documents/sean/code/experience-station/src/App.js":"3","/Users/sean/Documents/sean/code/experience-station/src/ConfirmModal.js":"4","/Users/sean/Documents/sean/code/experience-station/src/util.js":"5","/Users/sean/Documents/sean/code/experience-station/src/service.js":"6"},{"size":500,"mtime":1609655576049,"results":"7","hashOfConfig":"8"},{"size":362,"mtime":1609648754283,"results":"9","hashOfConfig":"8"},{"size":6013,"mtime":1609821183565,"results":"10","hashOfConfig":"8"},{"size":695,"mtime":1609761663832,"results":"11","hashOfConfig":"8"},{"size":942,"mtime":1609811112753,"results":"12","hashOfConfig":"8"},{"size":300,"mtime":1609821244820,"results":"13","hashOfConfig":"8"},{"filePath":"14","messages":"15","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"16"},"1ebqrgv",{"filePath":"17","messages":"18","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"16"},{"filePath":"19","messages":"20","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"21","usedDeprecatedRules":"16"},{"filePath":"22","messages":"23","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"24","usedDeprecatedRules":"16"},{"filePath":"25","messages":"26","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"16"},{"filePath":"27","messages":"28","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"/Users/sean/Documents/sean/code/experience-station/src/index.js",[],["29","30"],"/Users/sean/Documents/sean/code/experience-station/src/reportWebVitals.js",[],"/Users/sean/Documents/sean/code/experience-station/src/App.js",["31","32"],"import React, { useState, useEffect } from \"react\";\nimport { Button } from \"antd-mobile\";\nimport QRCode from \"qrcode.react\";\nimport ConfirmModal from \"./ConfirmModal\";\nimport starIcon from \"./assets/star.png\";\nimport nostarIcon from \"./assets/nostar.png\";\nimport logo from \"./assets/logo.png\";\nimport { moduleList, getQueryVariable, unique } from \"./util\";\nimport { getUseInfo, getSignature } from \"./service\";\nimport \"./App.css\";\n\n// https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx6ac3baea53cef467&redirect_uri=https%3a%2f%2fcoding-pages-bucket-3413143-8194751-9772-444098-1301636502.cos-website.ap-guangzhou.myqcloud.com%3fmoduleKey%3d02&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect\n\nfunction App() {\n  const code = getQueryVariable(\"code\");\n\n  const [visible, setVisible] = useState(false);\n  const [grade, setGrade] = useState(localStorage.getItem(\"grade\"));\n  const [nickname, setNickname] = useState(\n    localStorage.getItem(\"nickname\") || \"\"\n  );\n\n  const [experiencedModules, setExperiencedModules] = useState(\n    JSON.parse(localStorage.getItem(\"experiencedModules\")) || []\n  );\n\n  useEffect(() => {\n    if (!nickname) {\n      getUseInfo(code).then((res) => {\n        if (res.resultData) {\n          setNickname(res.resultData.nickname);\n          localStorage.setItem(\"nickname\", res.resultData.nickname);\n        }\n      });\n    }\n  }, [code]);\n\n  useEffect(() => {\n    getSignature(encodeURIComponent(window.location.href.split(\"#\")[0])).then(\n      (res) => {\n        if (res.resultStatus) {\n          const { appId, timestamp, nonceStr, signature } = res.resultData;\n          window.wx.config({\n            //debug: true,\n            appId: appId,\n            timestamp: timestamp.toString(), // 必填，生成签名的时间戳\n            nonceStr: nonceStr, // 必填，生成签名的随机串\n            signature: signature, // 必填，签名\n            jsApiList: [\"scanQRCode\"],\n          });\n        }\n      }\n    );\n  }, []);\n\n  const updateModules = (k) => {\n    const _experiencedModules = JSON.stringify(\n      unique([...experiencedModules, k])\n    );\n    localStorage.setItem(\"experiencedModules\", _experiencedModules);\n    setExperiencedModules(_experiencedModules);\n  };\n\n  useEffect(() => {\n    const currentKey = getQueryVariable(\"moduleKey\");\n    if (currentKey) updateModules(currentKey);\n  }, []);\n\n  const handleOk = () => {\n    let res = \"\";\n    if (experiencedModules.length > 10) {\n      res = \"优秀\";\n    } else if (experiencedModules.length > 8) {\n      res = \"良好\";\n    } else if (experiencedModules.length > 6) {\n      res = \"及格\";\n    } else {\n      res = \"不及格\";\n    }\n    setGrade(res);\n    localStorage.setItem(\"grade\", res);\n    setVisible(false);\n  };\n\n  return (\n    <div className=\"App\">\n      <div className=\"App-footer\">东莞城市服务驿站</div>\n\n      <header className=\"App-header\">\n        <img src={logo} className=\"App-logo\" alt=\"logo\" />\n        <div className=\"App-title\">\n          东莞市公安局\n          <br />\n          厚街分局\n        </div>\n        <div className=\"App-slogan\">\n          体育路警务工作站 <br />\n          欢迎您，{nickname}\n        </div>\n        <div className=\"App-tip\">注：点亮展项卡片，积分拿礼品</div>\n      </header>\n\n      <div className=\"content\">\n        {grade ? (\n          <div className=\"qrcode-container\">\n            <div className=\"qrcode-tip\">\n              完整的体验报告已生成 <br />\n              请至前台扫描二维码获取\n            </div>\n            <div className=\"qrcode-image\">\n              <QRCode size={200} value={`${nickname}#${grade}`} />\n            </div>\n          </div>\n        ) : (\n          <div>\n            {moduleList.map((item) => {\n              return (\n                <div\n                  className=\"module\"\n                  key={item.key}\n                  onClick={() => {\n                    if (!experiencedModules.includes(item.key)) {\n                      window.wx.scanQRCode({\n                        needResult: 1,\n                        scanType: [\"qrCode\", \"barCode\"],\n                        success: function (res) {\n                          const resultStr = decodeURIComponent(res.resultStr);\n                          const k = getQueryVariable(\n                            \"moduleKey\",\n                            resultStr.split(\"?\")[2]\n                          );\n                          updateModules(k);\n                        },\n                      });\n                    }\n                  }}\n                >\n                  <div className=\"module-title\">\n                    <span>{item.title}</span>\n                  </div>\n                  <div className=\"opration\">\n                    <img\n                      src={\n                        experiencedModules.includes(item.key)\n                          ? starIcon\n                          : nostarIcon\n                      }\n                      className=\"status-icon\"\n                      alt=\"icon\"\n                    />\n                    <Button\n                      className={`status-btn ${\n                        experiencedModules.includes(item.key) ? \"active\" : \"\"\n                      }`}\n                      size=\"small\"\n                    >\n                      {experiencedModules.includes(item.key)\n                        ? \" 已点亮\"\n                        : \"扫一扫点亮\"}\n                    </Button>\n                  </div>\n                </div>\n              );\n            })}\n            <Button\n              className=\"submit-btn\"\n              onClick={() => {\n                setVisible(true);\n              }}\n            >\n              结束展馆体验\n            </Button>\n          </div>\n        )}\n      </div>\n\n      <ConfirmModal\n        visible={visible}\n        handleClose={() => {\n          setVisible(false);\n        }}\n        handleOk={handleOk}\n      />\n    </div>\n  );\n}\n\nexport default App;\n","/Users/sean/Documents/sean/code/experience-station/src/ConfirmModal.js",["33"],"import React from \"react\";\nimport { Button, Modal } from \"antd-mobile\";\nimport \"./App.css\";\n\nexport default ({ visible, handleClose, handleOk }) => {\n  return (\n    <Modal\n      className=\"c-modal\"\n      visible={visible}\n      transparent\n      maskClosable={false}\n      onClose={handleClose}\n      title=\"东莞厚街平安便民服务站\"\n      afterClose={() => {}}\n    >\n      <div className=\"modal-content\">\n        <div className=\"confirm-text\">确定生成体验报告？</div>\n        <div className=\"actions\">\n          <Button onClick={() => handleOk()}>确定</Button>\n          <Button onClick={() => handleClose()}>取消</Button>\n        </div>\n      </div>\n    </Modal>\n  );\n};\n","/Users/sean/Documents/sean/code/experience-station/src/util.js",[],"/Users/sean/Documents/sean/code/experience-station/src/service.js",[],{"ruleId":"34","replacedBy":"35"},{"ruleId":"36","replacedBy":"37"},{"ruleId":"38","severity":1,"message":"39","line":36,"column":6,"nodeType":"40","endLine":36,"endColumn":12,"suggestions":"41"},{"ruleId":"38","severity":1,"message":"42","line":67,"column":6,"nodeType":"40","endLine":67,"endColumn":8,"suggestions":"43"},{"ruleId":"44","severity":1,"message":"45","line":5,"column":1,"nodeType":"46","endLine":25,"endColumn":3},"no-native-reassign",["47"],"no-negated-in-lhs",["48"],"react-hooks/exhaustive-deps","React Hook useEffect has a missing dependency: 'nickname'. Either include it or remove the dependency array.","ArrayExpression",["49"],"React Hook useEffect has a missing dependency: 'updateModules'. Either include it or remove the dependency array.",["50"],"import/no-anonymous-default-export","Assign arrow function to a variable before exporting as module default","ExportDefaultDeclaration","no-global-assign","no-unsafe-negation",{"desc":"51","fix":"52"},{"desc":"53","fix":"54"},"Update the dependencies array to be: [code, nickname]",{"range":"55","text":"56"},"Update the dependencies array to be: [updateModules]",{"range":"57","text":"58"},[1386,1392],"[code, nickname]",[2319,2321],"[updateModules]"]